% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/estimate_quantile_mediation_AB.R
\name{estimate_quantile_mediation_AB}
\alias{estimate_quantile_mediation_AB}
\title{Estimate Quantile Mediation Effects (Gaussian Copula + GLM Margins)}
\usage{
estimate_quantile_mediation_AB(
  data,
  tau = 1/2,
  x0 = 0,
  x1 = 1,
  W_new = NULL,
  W_cols = NULL,
  W_X_cols = NULL,
  W_M_cols = NULL,
  W_Y_cols = NULL,
  fam_X = gaussian(),
  fam_M = gaussian(),
  fam_Y = Gamma(link = "log"),
  disp_X = 1,
  disp_M = 1,
  disp_Y = 1,
  nb_size = NULL,
  pit_mode = c("midp", "jitter", "closed")
)
}
\arguments{
\item{data}{Data frame with columns \code{X}, \code{M}, \code{Y}, then covariates \code{W}.}

\item{tau}{Numeric, quantile level \eqn{\tau \in (0,1)}.}

\item{x0, x1}{Numeric, counterfactual exposure levels.}

\item{W_new}{1 \eqn{\times} p matrix of covariate values for counterfactual evaluation.}

\item{W_cols}{Integer indices of \code{W} columns in \code{data}.}

\item{W_X_cols, W_M_cols, W_Y_cols}{Integer indices (within \code{W_cols})
used in the \eqn{X|W}, \eqn{M|W}, and \eqn{Y|W} margins, respectively.}

\item{fam_X, fam_M, fam_Y}{\code{\link[stats]{family}} objects for the three margins.}

\item{disp_X, disp_M, disp_Y}{Numeric dispersion parameters (estimated internally if omitted).}

\item{nb_size}{Optional size (theta) for Negative-Binomial margins.}

\item{pit_mode}{One of \code{"midp"}, \code{"jitter"}, \code{"closed"} for discrete PIT handling.}
}
\value{
A list with elements:
\describe{
\item{\code{NIQE_hat}}{Estimated quantile indirect effect at \eqn{\tau}.}
\item{\code{alpha_hat}, \code{beta_hat}, \code{gamma_hat}}{Estimated copula parameters.}
\item{\code{delta_Y_hat}}{Scale factor for the latent \eqn{Y}.}
\item{\code{z_x0}, \code{z_x1}}{Probit PITs for \eqn{X} at \eqn{x_0}, \eqn{x_1}.}
\item{\code{I_alpha_hat}, \code{I_beta_hat}}{Pretest indicators.}
}
}
\description{
Fits a Gaussian-copula structural equation model with GLM margins for
exposure (\eqn{X}), mediator (\eqn{M}), and outcome (\eqn{Y}),
and computes plug-in estimators for quantile natural effects (Theorem 1).
}
\examples{
dat <- gen_data_quantile_mediation()
W_cols <- 4:ncol(dat)
est <- estimate_quantile_mediation_AB(
  data = dat,
  tau = 0.5,
  x0 = 0,
  x1 = 1,
  W_cols = W_cols,
  W_X_cols = 1:2,
  W_M_cols = 1:length(W_cols),
  W_Y_cols = 1:length(W_cols),
  W_new = matrix(0, 1, length(W_cols)),
  fam_X = gaussian(),
  fam_M = gaussian(),
  fam_Y = Gamma(link = "log")
)
}
