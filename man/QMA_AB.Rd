% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/QMA_AB.R
\name{QMA_AB}
\alias{QMA_AB}
\title{Adaptive Bootstrap Test for Quantile Mediation Effects}
\usage{
QMA_AB(data, R = 500, lambda = 2, tau = 1/2, x0 = 0, x1 = 1, W_new = NULL, ...)
}
\arguments{
\item{data}{Data frame with columns \code{X}, \code{M}, \code{Y}, then covariates \code{W}.}

\item{R}{Integer. Number of bootstrap replications.}

\item{lambda}{Numeric. Penalty scaling parameter; the test uses
\eqn{\lambda_n = \lambda \sqrt{n}/\log n} (default 2).}

\item{tau}{Numeric, quantile level \eqn{\tau \in (0,1)}.}

\item{x0, x1}{Numeric, counterfactual exposure levels.}

\item{W_new}{1 \eqn{\times} p matrix of covariate values for counterfactual evaluation.}
}
\value{
A numeric scalar p-value for testing the quantile indirect effect at \eqn{\tau}.
}
\description{
Implements the adaptive bootstrap (AB) procedure from the paper,
combining the classical bootstrap and a local-limit correction
to handle the degenerate null (\eqn{\alpha=\beta=0}).
}
\examples{
dat <- gen_data_quantile_mediation()
W_cols <- 4:ncol(dat)
pval <- QMA_AB(
  data = dat,
  R = 100,
  tau = 0.5,
  x0 = 0, x1 = 1,
  W_cols = W_cols,
  W_X_cols = 1:2,
  W_M_cols = 1:length(W_cols),
  W_Y_cols = 1:length(W_cols),
  W_new = matrix(0, 1, length(W_cols)),
  fam_X = gaussian(),
  fam_M = gaussian(),
  fam_Y = Gamma(link = "log")
)
}
